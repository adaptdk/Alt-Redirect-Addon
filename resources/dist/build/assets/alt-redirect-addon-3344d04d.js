function g(a,t,e,s,i,l,c,u){var r=typeof a=="function"?a.options:a;t&&(r.render=t,r.staticRenderFns=e,r._compiled=!0),s&&(r.functional=!0),l&&(r._scopeId="data-v-"+l);var o;if(c?(o=function(n){n=n||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!n&&typeof __VUE_SSR_CONTEXT__<"u"&&(n=__VUE_SSR_CONTEXT__),i&&i.call(this,n),n&&n._registeredComponents&&n._registeredComponents.add(c)},r._ssrRegister=o):i&&(o=u?function(){i.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:i),o)if(r.functional){r._injectStyles=o;var h=r.render;r.render=function(f,p){return o.call(p),h(f,p)}}else{var d=r.beforeCreate;r.beforeCreate=d?[].concat(d,o):[o]}return{exports:a,options:r}}const m={props:{title:String,instructions:String,action:String,blueprint:Array,meta:Array,redirectTo:String,values:Array,data:Array,items:Array},computed:{lastPage(){return this.paginationData.last_page||1}},data(){return{itemsSliced:[],perPage:10,currentPage:1,totalItems:0,selectedFile:null,search:"",fileName:"Choose a file...",selectedPage:"",paginationData:{current_page:1,last_page:1,per_page:10,total:0,from:0,to:0},searchTimeout:null,loading:!1,showForm:!0}},watch:{search:{handler(){this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.currentPage=1,this.fetchPaginatedData()},300)}}},mounted(){this.fetchPaginatedData()},methods:{async fetchPaginatedData(){this.loading=!0;try{const a=await Statamic.$axios.get(cp_url("alt-design/alt-redirect/paginated"),{params:{page:this.currentPage,per_page:this.perPage,search:this.search}});this.itemsSliced=a.data.data,this.paginationData={current_page:a.data.current_page,last_page:a.data.last_page,per_page:a.data.per_page,total:a.data.total,from:a.data.from,to:a.data.to},this.totalItems=a.data.total}catch(a){console.error("Error fetching paginated data:",a),this.$toast.error("Error loading redirects")}finally{this.loading=!1}},updateItems(a){this.values=a.data.values,this.showForm=!1,this.$nextTick(()=>{this.showForm=!0,this.$nextTick(()=>{this.$forceUpdate(),this.fetchPaginatedData()})})},setPage(a){a>=1&&a<=this.lastPage&&(this.currentPage=a,this.fetchPaginatedData())},deleteRedirect(a){confirm("Are you sure you want to delete this redirect?")&&Statamic.$axios.post(cp_url("alt-design/alt-redirect/delete"),{id:a}).then(t=>{this.$toast.success("Redirect deleted successfully"),this.fetchPaginatedData()}).catch(t=>{console.error(t),this.$toast.error("Error deleting redirect")})},importFromCSV(){if(confirm("Are you sure you want to import this CSV file? We recommend making a backup of the existing redirects first.")){if(!this.selectedFile){alert("You haven't attached a CSV file!");return}var a=new FormData;a.append("file",this.selectedFile),Statamic.$axios.post(cp_url("alt-design/alt-redirect/import"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.$toast.success("Redirects imported successfully"),this.fetchPaginatedData(),this.selectedFile=null,this.fileName="Choose a file..."}).catch(t=>{console.error(t),this.$toast.error("Invalid CSV file format. Check console for details.")})}},handleFileUpload(a){this.selectedFile=a.target.files[0],this.fileName=this.selectedFile?this.selectedFile.name:"Choose a file..."},dropdownPageChange(){this.setPage(parseInt(this.selectedPage))}}};var _=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"alt-redirect"}},[e("h1",{staticClass:"flex-1"},[t._v(t._s(t.title))]),e("h2",{staticClass:"flex-1"},[t._v(t._s(t.instructions))]),t.showForm?e("publish-form",{attrs:{title:"",action:t.action,blueprint:t.blueprint,meta:t.meta,values:t.values},on:{saved:function(s){return t.updateItems(s)}}}):t._e(),e("div",{staticClass:"card overflow-hidden p-0"},[e("div",{staticClass:"mt-4 pb-2 px-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"input-text",attrs:{type:"text",placeholder:"Search redirects...",disabled:t.loading},domProps:{value:t.search},on:{input:function(s){s.target.composing||(t.search=s.target.value)}}})]),e("div",{staticClass:"px-2"},[e("table",{staticClass:"data-table",staticStyle:{"table-layout":"fixed"},attrs:{"data-size":"sm",tabindex:"0"}},[t._m(0),e("tbody",[t.loading?e("tr",[t._m(1)]):t.itemsSliced.length===0?e("tr",[e("td",{staticClass:"text-center py-8 text-gray-600",attrs:{colspan:"6"}},[t._v(" "+t._s(t.search?"No redirects match your search.":"No redirects found.")+" ")])]):t._l(t.itemsSliced,function(s){return e("tr",{key:s.id,staticStyle:{width:"100%",overflow:"clip"}},[e("td",[t._v(" "+t._s(s.from)+" ")]),e("td",[t._v(" "+t._s(s.to)+" ")]),e("td",[t._v(" "+t._s(s.is_regex?"Regex":"Exact")+" ")]),e("td",[t._v(" "+t._s(s.redirect_type)+" ")]),e("td",[t._v(" "+t._s(s.sites&&s.sites.length?s.sites.join(", "):"Unknown")+" ")]),e("td",[e("button",{staticClass:"btn-danger",on:{click:function(i){return t.deleteRedirect(s.id)}}},[t._v("Remove")])])])})],2)])]),!t.loading&&t.totalItems>0?e("div",{staticClass:"pagination text-sm py-4 px-4 flex items-center justify-between"},[e("div",{staticClass:"w-1/3 flex items-center"},[t._v(" Page "),e("span",{staticClass:"font-semibold mx-1",domProps:{innerHTML:t._s(t.paginationData.current_page)}}),t._v(" of "),e("span",{staticClass:"mx-1",domProps:{innerHTML:t._s(t.paginationData.last_page)}})]),e("div",{staticClass:"w-1/3 flex items-center justify-center"},[t.currentPage>1?e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage-1>0?t.currentPage-1:1)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-LEFT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"LEFT","clip-path":"url(#clip-LEFT)"}},[e("rect",{attrs:{width:"205",height:"205","fill-opacity":"0"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M114.961,184.524l-9.91,9.91a10.669,10.669,0,0,1-15.132,0L3.143,107.7a10.669,10.669,0,0,1,0-15.132L89.919,5.794a10.669,10.669,0,0,1,15.132,0l9.91,9.91a10.725,10.725,0,0,1-.179,15.311L60.994,82.259H189.283A10.687,10.687,0,0,1,200,92.972v14.284a10.687,10.687,0,0,1-10.713,10.713H60.994l53.789,51.244A10.648,10.648,0,0,1,114.961,184.524Z",transform:"translate(2.004 2.353)"}})])])]):t._e(),t.currentPage>1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage==1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold text-blue",on:{click:function(s){return t.setPage(1)}}},[t._v("1")]):t._e(),t.currentPage>3?e("span",[t._v("...")]):t._e(),t.currentPage>2?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage-1)}}},[t._v(t._s(t.currentPage-1))]):t._e(),t.currentPage!==1&&t.currentPage!==t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold text-blue"},[t._v(t._s(t.currentPage))]):t._e(),t.currentPage<t.lastPage-1?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.currentPage+1)}}},[t._v(t._s(t.currentPage+1))]):t._e(),t.currentPage<t.lastPage-2?e("span",[t._v("...")]):t._e(),t.currentPage<t.lastPage?e("span",{staticClass:"cursor-pointer py-1 mx-1",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),t.currentPage==t.lastPage&&t.lastPage!=1?e("span",{staticClass:"cursor-pointer py-1 mx-1 font-semibold text-blue",on:{click:function(s){return t.setPage(t.lastPage)}}},[t._v(t._s(t.lastPage))]):t._e(),t.currentPage<t.lastPage?e("span",{staticClass:"cursor-pointer",staticStyle:{height:"15px",margin:"0 15px",width:"12px"},on:{click:function(s){return t.setPage(t.currentPage+1<t.lastPage?t.currentPage+1:t.lastPage)}}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"205",height:"205",viewBox:"0 0 205 205"}},[e("defs",[e("clipPath",{attrs:{id:"clip-RIGHT"}},[e("rect",{attrs:{width:"205",height:"205"}})])]),e("g",{attrs:{id:"RIGHT","clip-path":"url(#clip-RIGHT)"}},[e("rect",{attrs:{width:"205",height:"205","fill-opacity":"0"}}),e("path",{attrs:{stroke:"#2e9fff",fill:"#2e9fff",id:"Icon_awesome-arrow-left","data-name":"Icon awesome-arrow-left",d:"M85.032,184.524l9.91,9.91a10.669,10.669,0,0,0,15.132,0L196.85,107.7a10.669,10.669,0,0,0,0-15.132L110.073,5.794a10.669,10.669,0,0,0-15.132,0l-9.91,9.91a10.725,10.725,0,0,0,.179,15.311L139,82.259H10.71A10.687,10.687,0,0,0,0,92.972v14.284A10.687,10.687,0,0,0,10.71,117.969H139L85.21,169.214A10.648,10.648,0,0,0,85.032,184.524Z",transform:"translate(2.004 2.353)"}})])])]):t._e()]),e("div",{staticClass:"w-1/3 flex justify-end"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedPage,expression:"selectedPage"}],staticClass:"w-1/2 text-sm text-black",on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var c="_value"in l?l._value:l.value;return c});t.selectedPage=s.target.multiple?i:i[0]},t.dropdownPageChange]}},[e("option",{attrs:{value:"",disabled:""}},[t._v("Select Page")]),t._l(t.lastPage,function(s){return e("option",{key:s,domProps:{value:s}},[t._v(t._s(s))])})],2)])]):t._e()]),e("div",{staticClass:"flex justify-between"},[e("div",{staticClass:"w-full xl:w-1/2 card overflow-hidden p-0 mb-4 mt-4 mr-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Export")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Exports CSV of all redirects, use this format on import.")]),e("a",{staticClass:"btn-primary",attrs:{href:t.cp_url("/alt-design/alt-redirect/export"),download:""}},[t._v("Export CSV")])]),e("div",{staticClass:"w-full xl:w-1/2 card overflow-hidden p-0 mb-4 mt-4 ml-4 px-4 py-4"},[e("span",{staticClass:"font-semibold mb-2"},[t._v("CSV Import")]),e("br"),e("p",{staticClass:"text-sm mb-4"},[t._v("Import CSV for redirects, use the export format on import.")]),e("div",{staticClass:"flex justify-between items-center"},[e("div",[e("input",{staticClass:"hidden",attrs:{type:"file",id:"file-upload"},on:{change:t.handleFileUpload}}),e("label",{staticClass:"btn-primary",attrs:{for:"file-upload"}},[t._v("Upload File")]),e("span",{staticClass:"file-upload-cover px-4"},[t._v(t._s(t.fileName))])]),e("button",{staticClass:"btn-primary",on:{click:function(s){return t.importFromCSV()}}},[t._v("Import")])])])])],1)},v=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",{staticClass:"group from-column",staticStyle:{width:"33%"}},[t("span",[a._v("From")])]),t("th",{staticClass:"group from-column pr-8 w-24",staticStyle:{width:"33%"}},[t("span",[a._v("To")])]),t("th",{staticClass:"group to-column pr-8 w-8",staticStyle:{width:"8%"}},[t("span",[a._v("Match Type")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"8%"}},[t("span",[a._v("Type")])]),t("th",{staticClass:"group to-column pr-8",staticStyle:{width:"15%"}},[t("span",[a._v("Sites")])]),t("th",{staticClass:"actions-column",staticStyle:{width:"13.4%"}})])])},function(){var a=this,t=a._self._c;return t("td",{staticClass:"text-center py-8",attrs:{colspan:"6"}},[t("div",{staticClass:"loading inline-block"}),a._v(" Loading redirects... ")])}],P=g(m,_,v,!1,null,"bb79890b",null,null);const w=P.exports;Statamic.booting(()=>{Statamic.$components.register("alt-redirect",w)});
